# 🏗️ โครงสร้างระบบ - MAXIMUS MC Attendance System

<div align="center">

![Structure Guide](https://img.shields.io/badge/Structure-Guide-orange? style=for-the-badge)

**คำอธิบายโครงสร้างและความสัมพันธ์ของแต่ละ Sheet ในระบบ**

[🏠 กลับหน้าหลัก](README.md) • [⚙️ คู่มือติดตั้ง](SETUP.md) • [📐 สูตรที่ใช้](FORMULAS.md)

</div>

---

## 📋 สารบัญ

1. [ภาพรวมระบบ](#-ภาพรวมระบบ)
2. [โครงสร้างทั้ง 5 Sheets](#-โครงสร้างทั้ง-5-sheets)
3. [Data Flow Diagram](#-data-flow-diagram)
4.  [ความสัมพันธ์ระหว่าง Sheets](#-ความสัมพันธ์ระหว่าง-sheets)
5. [Cell Ranges สำคัญ](#-cell-ranges-สำคัญ)
6. [ข้อควรระวังในการแก้ไข](#️-ข้อควรระวังในการแก้ไข)

---

## 🎯 ภาพรวมระบบ

### สถาปัตยกรรมระบบ (System Architecture)

```
┌─────────────────────────────────────────────────────────────┐
│                    MAXIMUS MC ATTENDANCE                     │
│                   Google Sheets Application                  │
└─────────────────────────────────────────────────────────────┘
                              │
                ┌─────────────┴─────────────┐
                │                           │
        ┌───────▼────────┐         ┌───────▼────────┐
        │  Master Data   │         │  Apps Script   │
        │  (ข้อมูลหลัก) │         │  (Automation)  │
        └───────┬────────┘         └────────────────┘
                │
    ┌───────────┼───────────┬────────────┐
    │           │           │            │
┌───▼───┐  ┌───▼───┐  ┌───▼────┐  ┌───▼─────┐
│Daily  │  │Monthly│  │Dash-   │  │Settings │
│Entry  │  │Summary│  │board   │  │         │
└───────┘  └───────┘  └────────┘  └─────────┘
```

### หลักการทำงาน:

1. **Master Data** = แหล่งข้อมูลหลัก (Single Source of Truth)
2. **Daily Entry** = บันทึกข้อมูลรายวัน
3. **Monthly Summary** = สรุปข้อมูลจาก Daily Entry
4. **Dashboard** = แสดงภาพรวมจาก Monthly Summary
5. **Settings** = กำหนดค่าและกฎต่างๆ

---

## 📊 โครงสร้างทั้ง 5 Sheets

### 🗂️ Sheet 1: Dashboard

**หน้าที่:** แสดงภาพรวมและสถิติรวม

#### โครงสร้าง Layout:

```
┌────────────────────────────────────────────────────────┐
│  Row 1-3: HEADER (MAXIMUS MC - DASHBOARD)             │
├────────────────────────────────────────────────────────┤
│  Row 5-8: KPI CARDS                                    │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ │
│  │สมาชิก    │ │มาครบ     │ │ถูกปรับ    │ │ค่าปรับ   │ │
│  │   15     │ │   10     │ │    5     │ │ 500,000  │ │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘ │
├────────────────────────────────────────────────────────┤
│  Row 10-20: TOP RANKINGS                               │
│  ┌─────────────────┐  ┌─────────────────┐             │
│  │Top 5 ลาบ่อย     │  │Top 5 เลทบ่อย    │             │
│  │1. Name - 5 ครั้ง│  │1. Name - 8 ครั้ง│             │
│  │2.  Name - 4 ครั้ง│  │2. Name - 6 ครั้ง│             │
│  └─────────────────┘  └─────────────────┘             │
├────────────────────────────────────────────────────────┤
│  Row 22-35: CHARTS                                     │
│  ┌──────────────────────────────────────────────────┐ │
│  │         กราฟแนวโน้มการลา/เลท (Line Chart)        │ │
│  └──────────────────────────────────────────────────┘ │
└────────────────────────────────────────────────────────┘
```

#### Cell Ranges สำคัญ:

| Range | ชื่อ | ข้อมูล |
|-------|------|--------|
| B5 | TotalMembers | จำนวนสมาชิกทั้งหมด |
| C5 | PerfectAttendance | จำนวนคนมาครบ |
| D5 | FineCount | จำนวนคนถูกปรับ |
| E5 | TotalFines | ยอดค่าปรับรวม |
| B10:C15 | TopAbsent | Top 5 ลาบ่อย |
| D10:E15 | TopLate | Top 5 เลทบ่อย |

---

### ✍️ Sheet 2: ธันวาคม 2025 (บันทึกรายวัน)

**หน้าที่:** บันทึกการมา/ลา/เลท รายวัน

#### โครงสร้าง Layout:

```
┌────────────────────────────────────────────────────────┐
│  Row 1-6: HEADER + LOGO                                │
├────────────────────────────────────────────────────────┤
│  Row 8: สัปดาห์ที่ 1: 01/12 - 05/12                    │
│  Row 9: Column Headers                                 │
│  ┌─┬─────┬────┬──┬──┬──┬──┬──┬────┬────┐              │
│  │#│ชื่อ │ตำแ│จ. │อ.│พ.│พฤ│ศ. │ค่าป│หมาย│              │
│  │ │     │หน่ง│  │  │  │.  │  │รับ │เหตุ│              │
│  ├─┼─────┼────┼──┼──┼──┼──┼──┼────┼────┤              │
│  │1│Name │Pos │มา│มา│ลา│มา│มา│  0 │    │              │
│  │2│Name │Pos │มา│มา│มา│มา│มา│  0 │    │              │
│  │. │ ...  │... │.. │..│..│..│..│...  │    │              │
│  └─┴─────┴────┴──┴──┴──┴──┴──┴────┴────┘              │
│  (แถว 10-24 = 15 คน)                                  │
├────────────────────────────────────────────────────────┤
│  Row 26-42: สัปดาห์ที่ 2                               │
│  Row 44-60: สัปดาห์ที่ 3                               │
│  Row 62-78: สัปดาห์ที่ 4                               │
└────────────────────────────────────────────────────────┘
```

#### Cell Ranges สำคัญ:

| Range | Week | ข้อมูล |
|-------|------|--------|
| A10:J24 | Week 1 | สัปดาห์ที่ 1 (01/12-05/12) |
| A26:J42 | Week 2 | สัปดาห์ที่ 2 (08/12-12/12) |
| A44:J60 | Week 3 | สัปดาห์ที่ 3 (15/12-19/12) |
| A62:J78 | Week 4 | สัปดาห์ที่ 4 (22/12-26/12) |

#### รายละเอียดคอลัมน์:

| Column | ชื่อ | Type | สูตร/ข้อมูล |
|--------|------|------|------------|
| A | ลำดับ | Number | 1-15 |
| B | รายชื่อ | Text | =ข้อมูลพนักงาน! B2 |
| C | ตำแหน่ง | Text | =ข้อมูลพนักงาน!C2 |
| D | จันทร์ | Dropdown | มา/ลา/เลท |
| E | อังคาร | Dropdown | มา/ลา/เลท |
| F | พุธ | Dropdown | มา/ลา/เลท |
| G | พฤหัสบดี | Dropdown | มา/ลา/เลท |
| H | ศุกร์ | Dropdown | มา/ลา/เลท |
| I | ค่าปรับ | Formula | สูตรคำนวณ |
| J | หมายเหตุ | Text | ฟรีเทกซ์ |

---

### 📈 Sheet 3: สรุปรายเดือน

**หน้าที่:** สรุปผลรวมทั้งเดือน

#### โครงสร้าง Layout:

```
┌────────────────────────────────────────────────────────┐
│  Row 1: Column Headers                                 │
│  ┌─┬─────┬────┬──┬──┬──┬────┬────┐                    │
│  │#│ชื่อ │ตำแ│มา│ลา│เลท│ค่าป│สถา │                    │
│  │ │     │หน่ง│  │  │   │รับ │นะ  │                    │
│  ├─┼─────┼────┼──┼──┼──┼────┼────┤                    │
│  │1│Name │Pos │18│ 1│ 1│  0 │ปกติ│                    │
│  │2│Name │Pos │16│ 3│ 1│100K│ถูกป│                    │
│  │.│ ... │... │.. │..│..│...  │... │                    │
│  └─┴─────┴────┴──┴──┴──┴────┴────┘                    │
│  (แถว 2-16 = 15 คน)                                   │
└────────────────────────────────────────────────────────┘
```

#### Cell Ranges สำคัญ:

| Column | ชื่อ | Type | สูตร |
|--------|------|------|------|
| A | ลำดับ | Number | 1-15 |
| B | รายชื่อ | Text | =ข้อมูลพนักงาน!B2 |
| C | ตำแหน่ง | Text | =ข้อมูลพนักงาน!C2 |
| D | จำนวนวันมา | Formula | นับ "มา" ทั้งเดือน |
| E | จำนวนครั้งลา | Formula | นับ "ลา" ทั้งเดือน |
| F | จำนวนครั้งเลท | Formula | นับ "เลท" ทั้งเดือน |
| G | ค่าปรับรวม | Formula | รวมค่าปรับทั้งเดือน |
| H | สถานะ | Formula | =IF(G2>0,"ถูกปรับ","ปกติ") |

---

### 👥 Sheet 4: ข้อมูลพนักงาน (Master Data)

**หน้าที่:** เก็บข้อมูลสมาชิกหลัก

#### โครงสร้าง Layout:

```
┌────────────────────────────────────────────────────────┐
│  Row 1: Column Headers                                 │
│  ┌─┬──────────────┬────────────────┬────────┐         │
│  │#│ รายชื่อ      │ ตำแหน่ง        │ สถานะ  │         │
│  ├─┼──────────────┼────────────────┼────────┤         │
│  │1│Non Killer    │President       │Active  │         │
│  │2│Film Atlas    │Vice President  │Active  │         │
│  │3│Zaria Rayne   │Members         │Active  │         │
│  │. │...            │...             │...     │         │
│  │15│Sanim Rivera │Members         │Active  │         │
│  └─┴──────────────┴────────────────┴────────┘         │
└────────────────────────────────────────────────────────┘
```

#### ตำแหน่งทั้งหมด (Positions):

1. President (ประธาน)
2. Vice President (รองประธาน)
3. Road Captain (ผู้ดูแลการเดินทาง)
4. Secretary (เลขานุการ)
5.  Treasurer (เหรัญญิก)
6. Sergeant-at-Arms (ผู้คุมกฎ)
7. Enforcer (ผู้ดูแลการปฏิบัติ)
8. Members (สมาชิก)
9. Prospect (ผู้ทดลอง)
10. Hangaround (ผู้สนับสนุน)

---

### ⚙️ Sheet 5: การตั้งค่า (Settings)

**หน้าที่:** เก็บค่าคงที่และการตั้งค่า

#### โครงสร้าง Layout:

```
┌────────────────────────────────────────────────────────┐
│  Section 1: กฎการปรับ                                  │
│  ┌────────────────────┬───────┐                        │
│  │เลทกี่ครั้งถึงจะปรับ│   3   │                        │
│  │ค่าปรับเลท          │100,000│                        │
│  │ลากี่ครั้งถึงจะปรับ  │   2   │                        │
│  │ค่าปรับลา (ต่อครั้ง)│100,000│                        │
│  └────────────────────┴───────┘                        │
├────────────────────────────────────────────────────────┤
│  Section 2: วันทำงาน                                   │
│  ┌────────────────────┬───────────────────┐            │
│  │วันทำงาน            │จันทร์-ศุกร์       │            │
│  │วันหยุดพิเศษ        │(ระบุวันที่)       │            │
│  └────────────────────┴───────────────────┘            │
├────────────────────────────────────────────────────────┤
│  Section 3: Dropdown Values                            │
│  ┌────────────────────┬───────────────────┐            │
│  │สถานะ               │มา, ลา, เลท        │            │
│  └────────────────────┴───────────────────┘            │
├────────────────────────────────────────────────────────┤
│  Section 4: สี Theme                                   │
│  ┌────────────────────┬───────────────────┐            │
│  │สีสำหรับ "มา"       │#D9EAD3            │            │
│  │สีสำหรับ "ลา"       │#F4CCCC            │            │
│  │สีสำหรับ "เลท"      │#FFF2CC            │            │
│  └────────────────────┴───────────────────┘            │
└────────────────────────────────────────────────────────┘
```

---

## 🔄 Data Flow Diagram

### ขั้นตอนการไหลของข้อมูล:

```
Step 1: ใส่ข้อมูลสมาชิก
┌───────────────────┐
│  ข้อมูลพนักงาน    │
│  (Master Data)    │
└─────────┬─────────┘
          │
          ▼
┌─────────────────────────────────────────┐
│  รายชื่อและตำแหน่งถูกดึงมาใช้อัตโนมัติ  │
└─────────────────────────────────────────┘
          │
          ├──────────┬──────────┬──────────┐
          ▼          ▼          ▼          ▼
    ┌─────────┐ ┌─────────┐ ┌────────┐ ┌─────┐
    │Daily    │ │Monthly  │ │Dash-   │ │etc.  │
    │Entry    │ │Summary  │ │board   │ │     │
    └─────────┘ └─────────┘ └────────┘ └─────┘

Step 2: บันทึกรายวัน
┌───────────────────┐
│  ธันวาคม 2025     │
│  (Daily Entry)    │
│  - เลือก มา/ลา/เลท│
└─────────┬─────────┘
          │
          ▼
┌─────────────────────────────────────────┐
│  สูตรคำนวณค่าปรับอัตโนมัติ              │
└─────────────────────────────────────────┘
          │
          ▼
    ┌──────────┐
    │ค่าปรับ    │
    │แสดงทันที  │
    └──────────┘

Step 3: สรุปรายเดือน
┌───────────────────┐
│  ธันวาคม 2025     │
│  (4 สัปดาห์)      │
└─────────┬─────────┘
          │
          ▼
┌─────────────────────────────────────────┐
│  สูตรนับและรวมข้อมูลทั้งเดือน          │
└─────────┬───────────────────────────────┘
          │
          ▼
┌───────────────────┐
│  สรุปรายเดือน     │
│  (Monthly Summary)│
└─────────┬─────────┘
          │
          ▼
┌─────────────────────────────────────────┐
│  - จำนวนครั้งมา/ลา/เลท                │
│  - ค่าปรับรวมทั้งเดือน                 │
│  - สถานะ (ปกติ/ถูกปรับ)                │
└─────────────────────────────────────────┘

Step 4: Dashboard
┌───────────────────┐
│  สรุปรายเดือน     │
└─────────┬─────────┘
          │
          ▼
┌─────────────────────────────────────────┐
│  สูตรดึงข้อมูลและสรุป                   │
└─────────┬───────────────────────────────┘
          │
          ▼
┌───────────────────┐
│  Dashboard        │
│  - KPI Cards      │
│  - Top Rankings   │
│  - Charts         │
└───────────────────┘
```

---

## 🔗 ความสัมพันธ์ระหว่าง Sheets

### แผนภาพความสัมพันธ์:

```
                    ┌─────────────────┐
                    │ ข้อมูลพนักงาน    │
                    │  (Master Data)  │
                    └────────┬────────┘
                             │
              ┌──────────────┼──────────────┐
              │              │              │
              ▼              ▼              ▼
    ┌─────────────┐  ┌─────────────┐  ┌──────────┐
    │ ธันวาคม 2025│  │สรุปรายเดือน │  │Dashboard │
    │ (ดึงชื่อ/ตำ)│  │(ดึงชื่อ/ตำ) │  │          │
    └──────┬──────┘  └──────┬──────┘  └────┬─────┘
           │                │              │
           └────────┬───────┘              │
                    ▼                      │
            ┌───────────────┐              │
            │ สรุปรายเดือน   │              │
            │(นับข้อมูลจาก  │◄─────────────┘
            │ ธันวาคม 2025) │
            └───────┬───────┘
                    │
                    ▼
            ┌───────────────┐
            │  Dashboard    │
            │(ดึงข้อมูลจาก │
            │ สรุปรายเดือน) │
            └───────────────┘
```

### การอ้างอิง (References):

| Sheet จาก → ไป | การอ้างอิง | ตัวอย่างสูตร |
|----------------|-----------|-------------|
| ข้อมูลพนักงาน → ธันวาคม 2025 | ชื่อ, ตำแหน่ง | `=ข้อมูลพนักงาน!B2` |
| ข้อมูลพนักงาน → สรุปรายเดือน | ชื่อ, ตำแหน่ง | `=ข้อมูลพนักงาน!B2` |
| ธันวาคม 2025 → สรุปรายเดือน | นับ มา/ลา/เลท | `=COUNTIF('ธันวาคม 2025'!D10:H24,"มา")` |
| สรุปรายเดือน → Dashboard | KPI, Rankings | `=SUM('สรุปรายเดือน'!G2:G16)` |
| การตั้งค่า → ทุก Sheet | กฎ, ค่าคงที่ | อ้างอิงค่าจากการตั้งค่า |

---

## 📍 Cell Ranges สำคัญ

### Named Ranges (แนะนำให้ตั้ง):

| ชื่อ | Range | Sheet | ความหมาย |
|------|-------|-------|----------|
| MasterNames | B2:B16 | ข้อมูลพนักงาน | รายชื่อทั้งหมด |
| MasterPositions | C2:C16 | ข้อมูลพนักงาน | ตำแหน่งทั้งหมด |
| Week1_Data | D10:H24 | ธันวาคม 2025 | ข้อมูลสัปดาห์ 1 |
| Week2_Data | D26:H42 | ธันวาคม 2025 | ข้อมูลสัปดาห์ 2 |
| Week3_Data | D44:H60 | ธันวาคม 2025 | ข้อมูลสัปดาห์ 3 |
| Week4_Data | D62:H78 | ธันวาคม 2025 | ข้อมูลสัปดาห์ 4 |
| MonthlyFines | G2:G16 | สรุปรายเดือน | ค่าปรับทั้งหมด |

### วิธีตั้ง Named Range:

1. เลือก Range ที่ต้องการ
2. ไปที่ **Data** > **Named ranges**
3. ใส่ชื่อ (เช่น "MasterNames")
4. กด **Done**

---

## ⚠️ ข้อควรระวังในการแก้ไข

### 🔴 ห้ามแก้ไข (Critical Areas)

1. ❌ **อย่าลบ Sheet "ข้อมูลพนักงาน"** - Sheet อื่นจะ Error
2. ❌ **อย่าเปลี่ยนชื่อคอลัมน์ใน Master Data** - สูตรจะหา Reference ไม่เจอ
3. ❌ **อย่าลบแถว Header** - โครงสร้างจะพัง
4. ❌ **อย่าแก้ไขสูตรโดยไม่เข้าใจ** - อาจทำให้คำนวณผิด

### 🟡 แก้ไขได้แต่ระวัง (Caution)

1. ⚠️ **เพิ่ม/ลดสมาชิก** - ต้องอัปเดตสูตรทุก Sheet
2. ⚠️ **เปลี่ยนกฎการปรับ** - ต้องแก้ไขสูตรคำนวณ
3.  ⚠️ **เปลี่ยนชื่อ Sheet** - ต้องอัปเดตสูตรที่อ้างอิง
4. ⚠️ **เพิ่มคอลัมน์** - ต้องปรับ Cell Reference

### 🟢 แก้ไขได้อย่างอิสระ (Safe)

1. ✅ **สี Theme** - เปลี่ยนสีได้ตามชอบ
2. ✅ **ฟอนต์** - เปลี่ยนฟอนต์ได้
3. ✅ **ข้อมูลใน Daily Entry** - บันทึก มา/ลา/เลท ได้เลย
4. ✅ **หมายเหตุ** - ใส่หมายเหตุได้
5. ✅ **กราฟ** - ปรับแต่งกราฟได้

---

## 🛠️ Tips การดูแลรักษาระบบ

### ✅ ควรทำเป็นประจำ:

1. **Backup รายสัปดาห์**
   - File > Make a copy
   - เก็บไว้ใน Google Drive

2. **ตรวจสอบสูตร**
   - ใช้เมนู MAXIMUS MC > ตรวจสอบข้อมูล
   - ดู Error ที่อาจเกิดขึ้น

3. **ทำความสะอาดข้อมูล**
   - ลบ Sheet เดือนเก่าที่ไม่ใช้
   - Archive ข้อมูลเก่า

### 🔧 แก้ไขปัญหา:

**ถ้าสูตรแสดง #REF!**
- มีการลบเซลล์/Sheet ที่สูตรอ้างอิง
- แก้: ตรวจสอบและแก้ไข Reference

**ถ้าสูตรแสดง #VALUE!**
- มีข้อมูลผิดประเภท (เช่น ใส่ตัวเลขแทนข้อความ)
- แก้: ตรวจสอบข้อมูลในเซลล์

**ถ้าสูตรแสดง #DIV/0!**
- หารด้วย 0
- แก้: ใส่เงื่อนไข IF ป้องกัน

---

## 📚 สรุป

### ความเข้าใจที่สำคัญ:

1. ✅ **Master Data** เป็นหัวใจของระบบ
2. ✅ **Daily Entry** บันทึกข้อมูลรายวัน
3. ✅ **Monthly Summary** สรุปจาก Daily Entry
4. ✅ **Dashboard** แสดงผลจาก Monthly Summary
5. ✅ **Settings** เก็บค่าคงที่

### Data Flow:
```
Master Data → Daily Entry → Monthly Summary → Dashboard
```

### ข้อควรจำ:
- 🔴 อย่าลบ Master Data
- 🟡 ระวังตอนแก้ไขสูตร
- 🟢 บันทึกข้อมูลได้อย่างอิสระ

---

<div align="center">

**🏗️ เข้าใจโครงสร้างแล้ว ใช้งานได้อย่างมั่นใจ!  🏗️**

[🏠 กลับหน้าหลัก](README.md) • [⚙️ คู่มือติดตั้ง](SETUP.md) • [📐 สูตรที่ใช้](FORMULAS.md)

**Made with ❤️ for MAXIMUS MC**

</div>
